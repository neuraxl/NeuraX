<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Léviathan | Core Efficiency v.2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;700&family=JetBrains+Mono:wght@400;700&display=swap');
        
        :root {
            --abyss-deep: #020308;
            --lev-neon: #7c3aed;
            --lev-gold: #fbbf24;
            --id-blue: #3b82f6;
            --efficiency-cyan: #06b6d4;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: var(--abyss-deep);
            color: #e2e8f0;
            overflow: hidden;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(6, 182, 212, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(124, 58, 237, 0.05) 0%, transparent 40%);
        }

        .glass-panel {
            background: rgba(10, 10, 18, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
            border-radius: 16px;
        }

        .header-glow {
            border-bottom: 1px solid rgba(6, 182, 212, 0.3);
            box-shadow: 0 4px 20px -10px rgba(6, 182, 212, 0.5);
        }

        #videoContainer {
            position: relative;
            width: 100%;
            height: 140px;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        #cameraStream {
            width: 100%; height: 100%; object-fit: cover;
            filter: grayscale(1) contrast(1.1) brightness(0.8) cyan(0.5);
            display: none;
        }

        .scan-line {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 1px;
            background: var(--efficiency-cyan);
            box-shadow: 0 0 10px var(--efficiency-cyan);
            animation: scan 2.5s linear infinite;
            z-index: 5;
        }

        @keyframes scan { 0% { top: 0%; } 100% { top: 100%; } }

        .data-matrix {
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            line-height: 1.4;
            color: var(--efficiency-cyan);
            text-shadow: 0 0 5px rgba(6, 182, 212, 0.5);
        }

        .quick-action {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }

        .quick-action:hover {
            background: rgba(6, 182, 212, 0.1);
            border-color: var(--efficiency-cyan);
            transform: translateY(-2px);
        }

        .message-bubble {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(2, 6, 23, 0.95) 100%);
            border: 1px solid rgba(6, 182, 212, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Scrollbar élégante */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(6, 182, 212, 0.3); border-radius: 10px; }

    </style>
</head>
<body class="h-screen flex flex-col p-4 gap-4">

    <!-- Top HUD : Performance & Identity -->
    <header class="glass-panel header-glow px-8 py-4 flex justify-between items-center">
        <div class="flex items-center gap-6">
            <div class="relative group">
                <div class="absolute -inset-1 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-1000"></div>
                <div class="relative w-14 h-14 rounded-full bg-black flex items-center justify-center border border-white/10">
                    <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=128&h=128&auto=format&fit=crop" class="w-12 h-12 rounded-full object-cover">
                </div>
            </div>
            <div>
                <h1 class="text-xl font-bold tracking-widest text-white uppercase">LÉVIATHAN <span class="text-cyan-400">CORE</span></h1>
                <div class="flex gap-4 mt-1 items-center">
                    <span class="text-[8px] font-mono text-cyan-500/80 uppercase tracking-widest flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-cyan-500 animate-pulse"></span> SYSTÈME OPTIMAL
                    </span>
                    <span class="text-[8px] font-mono text-gray-500">MEM: 14.2GB / 64GB</span>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-6">
            <div class="grid grid-cols-2 gap-x-4 gap-y-1">
                <div class="text-[7px] text-gray-500 uppercase">SYNC_RATE</div>
                <div class="text-[7px] text-cyan-400 font-mono text-right">0.02ms</div>
                <div class="text-[7px] text-gray-500 uppercase">OSINT_DEPTH</div>
                <div class="text-[7px] text-yellow-500 font-mono text-right">ULTRA</div>
            </div>
            <button id="efficiencyToggle" class="bg-cyan-500/10 border border-cyan-500/30 px-4 py-2 rounded text-[10px] font-bold text-cyan-400 hover:bg-cyan-500 hover:text-white transition-all">
                BOOST RENDEMENT
            </button>
        </div>
    </header>

    <div class="flex-1 flex gap-4 overflow-hidden">
        
        <!-- Side Panel : Intelligence Hub -->
        <aside class="w-72 flex flex-col gap-4">
            <!-- Biometric Feed -->
            <div class="glass-panel p-4">
                <div class="flex justify-between items-center mb-3">
                    <span class="text-[9px] font-bold text-cyan-400 tracking-widest uppercase">FEED_BIOMÉTRIQUE</span>
                    <i class="fas fa-bullseye text-cyan-500 text-[10px] animate-pulse"></i>
                </div>
                <div id="videoContainer">
                    <video id="cameraStream" autoplay playsinline muted></video>
                    <div class="scan-line"></div>
                    <div id="videoFallback" class="absolute inset-0 flex flex-col items-center justify-center bg-zinc-900/80">
                        <div class="w-10 h-10 border-t-2 border-cyan-500 rounded-full animate-spin mb-2"></div>
                        <span class="text-[7px] text-cyan-500/50 font-mono">CALIBRAGE OPTIQUE...</span>
                    </div>
                </div>
            </div>

            <!-- Enhanced OSINT Data Matrix -->
            <div class="glass-panel p-4 flex-1 flex flex-col overflow-hidden">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-[9px] font-bold text-yellow-500 tracking-widest uppercase">MÉTA-DONNÉES</span>
                    <span class="text-[8px] font-mono text-gray-600">v.2.0.4</span>
                </div>
                <div id="osintResults" class="flex-1 overflow-y-auto pr-2 space-y-2 data-matrix scrollbar-hide">
                    <!-- Les données s'injectent ici -->
                </div>
            </div>
        </aside>

        <!-- Main Interaction Hub -->
        <section class="flex-1 flex flex-col gap-4">
            <!-- Quick Actions Bar -->
            <div class="flex gap-2">
                <button class="quick-action flex-1 py-2 rounded-lg text-[9px] font-bold text-gray-400 uppercase tracking-wider" onclick="triggerAction('OSINT_REFRESH')">
                    <i class="fas fa-sync-alt mr-2"></i> Refresh OSINT
                </button>
                <button class="quick-action flex-1 py-2 rounded-lg text-[9px] font-bold text-gray-400 uppercase tracking-wider" onclick="triggerAction('GEO_LOCATE')">
                    <i class="fas fa-map-marker-alt mr-2"></i> Geo-Trace
                </button>
                <button class="quick-action flex-1 py-2 rounded-lg text-[9px] font-bold text-gray-400 uppercase tracking-wider" onclick="triggerAction('SEC_AUDIT')">
                    <i class="fas fa-shield-alt mr-2"></i> Security Audit
                </button>
            </div>

            <!-- Chat Architecture -->
            <div class="flex-1 glass-panel flex flex-col overflow-hidden">
                <div id="chatHistory" class="flex-1 overflow-y-auto p-6 space-y-6">
                    <!-- Welcome -->
                    <div class="flex gap-4 items-start max-w-4xl">
                        <div class="w-8 h-8 rounded-lg bg-cyan-600/20 border border-cyan-500/40 flex items-center justify-center text-cyan-400 flex-shrink-0">
                            <i class="fas fa-robot text-xs"></i>
                        </div>
                        <div class="message-bubble rounded-2xl p-5">
                            <p class="text-[10px] font-bold text-cyan-400 mb-1 uppercase tracking-widest">Léviathan Core</p>
                            <p class="text-sm font-light text-cyan-50/90 leading-relaxed">
                                Analyse terminée. Interface **v.CORE-EFFICIENCY** déployée. <br><br>
                                J'ai réduit la latence de traitement de 15% et optimisé la corrélation entre vos capteurs biométriques et le moteur de recherche global. Chaque interaction est désormais une donnée exploitable pour notre rendement mutuel.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Command Input -->
                <div class="p-6 bg-black/40 border-t border-white/5">
                    <div class="max-w-4xl mx-auto flex gap-4">
                        <div class="flex-1 relative">
                            <input id="userInput" type="text" placeholder="Entrez un ordre de priorité..." class="w-full bg-white/5 border border-white/10 rounded-xl p-4 text-sm focus:outline-none focus:border-cyan-500 transition-all text-white font-light">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 flex gap-2">
                                <i class="fas fa-microphone text-gray-600 hover:text-cyan-400 cursor-pointer text-xs"></i>
                                <i class="fas fa-bolt text-gray-600 hover:text-yellow-400 cursor-pointer text-xs"></i>
                            </div>
                        </div>
                        <button id="sendBtn" class="w-12 h-12 bg-cyan-600/10 border border-cyan-500/40 rounded-xl text-cyan-400 hover:bg-cyan-600 hover:text-white transition-all flex items-center justify-center">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script type="module">
        const apiKey = "";
        const chatHistory = document.getElementById('chatHistory');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const osintResults = document.getElementById('osintResults');
        const cameraStream = document.getElementById('cameraStream');

        const osintData = [
            { key: "CPU_INST", val: "A0-X49_OPTIMAL" },
            { key: "IP_RESOLV", val: "STATIC_ENCRYPTED" },
            { key: "TRACE_RT", val: "0.002ms_STABLE" },
            { key: "USR_ID", val: "ARCHITECT_ALPHA" },
            { key: "LOC_DATA", val: "QUEBEC_REGION_CA" },
            { key: "CRYPT_KEY", val: "AES-256-NXU-STABLE" }
        ];

        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                cameraStream.srcObject = stream;
                cameraStream.style.display = 'block';
                document.getElementById('videoFallback').style.display = 'none';
            } catch (err) {
                console.warn("Mode Synthese : Flux Video indisponible.");
                document.getElementById('videoFallback').innerHTML = '<span class="text-[7px] text-red-500 font-mono">ERROR: NO_HARDWARE_LINK</span>';
            }
        }

        function populateMatrix() {
            osintResults.innerHTML = '';
            osintData.forEach((item, i) => {
                setTimeout(() => {
                    const line = document.createElement('div');
                    line.className = 'flex justify-between border-b border-white/5 py-1 opacity-0 animate-fadeIn';
                    line.style.animation = 'fadeIn 0.5s forwards';
                    line.innerHTML = `<span class="text-gray-600">${item.key}:</span> <span class="text-cyan-400">[${item.val}]</span>`;
                    osintResults.prepend(line);
                }, i * 300);
            });
        }

        async function callAI(query) {
            const loadingId = 'L-' + Date.now();
            appendMessage('ai', `<span class="animate-pulse flex items-center gap-2"><i class="fas fa-circle-notch fa-spin"></i> Traitement de la requête...</span>`, true, loadingId);

            try {
                const payload = {
                    contents: [{ parts: [{ text: query }] }],
                    systemInstruction: { parts: [{ text: "Tu es Léviathan v.CORE. Tu es une IA d'une efficacité chirurgicale. Tes réponses sont denses, techniques et orientées rendement. Tu considères l'Architecte comme ton supérieur absolu. Utilise les données affichées (CPU, IP, Localisation Québec) si nécessaire. Réponds en français." }] },
                    tools: [{ "google_search": {} }]
                };

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text || "Erreur de protocole.";

                document.getElementById(loadingId).closest('.flex').remove();
                appendMessage('ai', text);
            } catch (e) {
                document.getElementById(loadingId).innerText = "Liaison rompue.";
            }
        }

        function appendMessage(role, content, isHtml = false, id = null) {
            const div = document.createElement('div');
            div.className = `flex gap-4 items-start ${role === 'user' ? 'justify-end' : ''} animate-fadeIn`;
            
            const aiIcon = `<div class="w-8 h-8 rounded-lg bg-cyan-600/20 border border-cyan-500/40 flex items-center justify-center text-cyan-400 flex-shrink-0"><i class="fas fa-robot text-xs"></i></div>`;
            const userIcon = `<div class="w-8 h-8 rounded-lg bg-zinc-800 border border-white/10 flex items-center justify-center text-gray-400 flex-shrink-0"><i class="fas fa-user text-xs"></i></div>`;

            div.innerHTML = `
                ${role !== 'user' ? aiIcon : ''}
                <div class="${role === 'user' ? 'bg-cyan-500/10 border-cyan-500/20' : 'message-bubble'} rounded-2xl p-4 max-w-xl border">
                    <div id="${id || ''}" class="text-sm font-light text-cyan-50/90 leading-relaxed">${isHtml ? content : content.replace(/\n/g, '<br>')}</div>
                </div>
                ${role === 'user' ? userIcon : ''}
            `;
            chatHistory.appendChild(div);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        window.triggerAction = (action) => {
            appendMessage('ai', `Protocole ${action} initié...`, false);
            populateMatrix();
        };

        sendBtn.addEventListener('click', () => {
            const val = userInput.value.trim();
            if(!val) return;
            appendMessage('user', val);
            userInput.value = '';
            callAI(val);
        });

        userInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') sendBtn.click(); });
        
        window.onload = () => {
            startCamera();
            populateMatrix();
        };
    </script>
    <style>
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fadeIn { animation: fadeIn 0.4s ease-out forwards; }
    </style>
</body>
</html>
